<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/..\FrameXML\UI.xsd">
    <Script file="main.lua" />
    <Frame name="CompactGroupFrame" parent="UIParent" movable="true" resizeable="true" frameStrata="BACKGROUND" hidden="true">
        <Size x="72" y="0"/>
        <ResizeBounds>
            <minResize x="96" y="64" />
            <maxResize x="180" y="64" />
        </ResizeBounds>
        <Anchors>
            <Anchor point="LEFT" relativeTo="UIParent">
                <Offset x="25" y="180" />
            </Anchor>
        </Anchors>
        <Backdrop bgFile="Interface/Tooltips/UI-Tooltip-Background" edgeFile="Interface/Tooltips/UI-Tooltip-Border">
            <Color r="0" g="0" b="0" a="0" />
            <BorderColor r="0.5" g="0.5" b="0.5" a="1" />
            <EdgeSize>
                <AbsValue val="16"/>
            </EdgeSize>
            <BackgroundInsets>
                <AbsInset left="-5" right="-5" top="-8" bottom="-5"/>
            </BackgroundInsets>
        </Backdrop>
        <Frames>
            <Frame name="CompactUnitFrame1" inherits="CompactUnitFrameTemplate" />
            <Frame name="CompactUnitFrame2" inherits="CompactUnitFrameTemplate" />
            <Frame name="CompactUnitFrame3" inherits="CompactUnitFrameTemplate" />
            <Frame name="CompactUnitFrame4" inherits="CompactUnitFrameTemplate" />
            <Frame name="CompactUnitFrame5" inherits="CompactUnitFrameTemplate" />
        </Frames>
        <Scripts>
            <OnLoad>
                this:RegisterEvent('VARIABLES_LOADED')
                this:RegisterEvent('PLAYER_ENTERING_WORLD')
                this:RegisterEvent('PARTY_MEMBERS_CHANGED')

                this:RegisterForDrag('LeftButton')
                this:SetClampedToScreen()
                this:SetHitRectInsets(-8, -8, -10, -8)

                this:SetFrameLevel(1)
            </OnLoad>
            <OnEvent>
                if event == 'VARIABLES_LOADED' then
                    if not CRF_Settings then
                        CRF_Settings = {
                            ['frame_border'] = true,
                            ['unit_colors'] = true,
                            ['unit_health'] = false,
                            ['unit_power'] = true
                        }
                    end

                    CRF_Init()
                end

                CRF_UpdateFrames()
            </OnEvent>
            <OnEnter>
                if not UnitAffectingCombat('player') and IsControlKeyDown() then
                    this:SetBackdropColor(0, 0, 0, 0.5)
                end
            </OnEnter>
            <OnLeave>
                this:SetBackdropColor(0, 0, 0, 0)
            </OnLeave>
            <OnDragStart>
                if not UnitAffectingCombat('player') and IsControlKeyDown() then
                    if IsAltKeyDown() then
                        this:StartSizing()
                    else
                        this:StartMoving()
                    end
                end
            </OnDragStart>
            <OnSizeChanged>
                if this.ready then
                    CRF_UpdateFrames()
                end
            </OnSizeChanged>
            <OnDragStop>
                this:StopMovingOrSizing()

                CRF_UpdateFrames()
            </OnDragStop>
        </Scripts>
    </Frame>
</Ui>